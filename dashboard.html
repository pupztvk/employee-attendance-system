<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô - HR System</title>
  
  <link rel="stylesheet" href="css/dashboard.css?v=20260219-4">
  
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>

</head>
<body>

  <nav class="navbar">
    <div class="nav-brand">üöÄ HR System</div>
    <div class="nav-menu">
      <button id="navAttendance" class="nav-btn active">üìã ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</button>
      <button id="navHistory" class="nav-btn">üìú ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥/‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
      <button id="navEmployee" class="nav-btn">‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</button>
      <button id="navMobileQR" class="nav-btn nav-btn-qr">üì± QR ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</button>
      <button id="logoutBtn" class="nav-btn logout">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>
  </nav>

  <div class="container">
    
    <div id="section-attendance" class="content-section active">
      <div class="card-header">
        <h2>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</h2>
        <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</p>
      </div>

      <div class="filter-section">
        <div class="form-group"><label>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label><input type="date" id="dateInput"></div>
        <div class="form-group"><label>‚è∞ ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</label><select id="period_select"><option value="morning">üåÖ ‡πÄ‡∏ä‡πâ‡∏≤</option><option value="afternoon">üåá ‡∏ö‡πà‡∏≤‡∏¢ (+OT)</option></select></div>
        <div class="form-group"><label>üè¢ ‡πÅ‡∏ú‡∏ô‡∏Å</label><select id="dept_filter"><option value="">-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å --</option><option value="IT">‡∏ù‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ</option><option value="‡∏ö‡∏±‡∏ç‡∏ä‡∏µ">‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏®</option><option value="‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•">‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</option><option value="‡∏Ç‡∏≤‡∏¢">‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£</option></select></div>
      </div>

      <div class="table-responsive">
        <table>
          <thead>
            <tr>
                <th width="10%">‡πÅ‡∏ú‡∏ô‡∏Å</th><th width="15%">‡∏£‡∏´‡∏±‡∏™</th><th width="25%">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                <th width="10%">‡∏°‡∏≤</th><th width="10%">‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</th><th width="10%">‡∏•‡∏≤‡∏Å‡∏¥‡∏à</th><th width="10%">‡∏Ç‡∏≤‡∏î</th>
                <th width="10%" id="th_ot" style="display:none;">OT</th>
            </tr>
          </thead>
          <tbody id="attendanceTableBody">
            <tr>
                <td colspan="8" style="padding: 60px; color: #999;">
                    <div style="font-size: 40px; margin-bottom: 15px;">üè¢</div>
                    ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å <b>"‡πÅ‡∏ú‡∏ô‡∏Å"</b> ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠
                </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="attendance-action-row">
        <button id="saveAttendanceBtn" class="btn-main">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</button>
        <button id="editAttendanceBtn" class="btn-main btn-edit">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</button>
      </div>
    </div>

    <div id="section-history" class="content-section">
      <div class="card-header">
        <h2>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ / ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h2>
        <p>‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</p>
      </div>
      
      <div class="filter-section">
  <div class="form-group">
    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
    <input type="date" id="hist_date">
  </div>

  <div class="form-group">
    <label>‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</label>
    <select id="hist_period">
      <option value="all">‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</option>   <!-- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° -->
      <option value="morning">‡πÄ‡∏ä‡πâ‡∏≤</option>
      <option value="afternoon">‡∏ö‡πà‡∏≤‡∏¢</option>
    </select>
  </div>

  <div class="form-group">
    <label>‡πÅ‡∏ú‡∏ô‡∏Å</label>
    <select id="hist_dept">
      <option value="IT">‡∏ù‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ</option>
      <option value="‡∏ö‡∏±‡∏ç‡∏ä‡∏µ">‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏®</option>
      <option value="‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•">‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</option>
      <option value="‡∏Ç‡∏≤‡∏¢">‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£</option>
    </select>
  </div>

  <div class="form-group" style="flex:0;">
    <button id="searchHistoryBtn" class="btn-search">üîç</button>
  </div>
</div>


      <div id="statsContainer" style="display:none; margin-bottom: 20px; background: #f8f9fa; padding: 20px; border-radius: 20px;">
  <h3 style="text-align:center; font-size:16px; margin-bottom:10px; color:#555;">‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h3>

  <div class="stats-grid" style="display:grid; grid-template-columns: 1.2fr 1.2fr .8fr; gap:20px; align-items:center;">
    
    <!-- ‡∏Å‡∏£‡∏≤‡∏ü‡∏ß‡∏á‡∏Å‡∏•‡∏° -->
    <div class="chart-box" style="height:220px;">
      <canvas id="attendanceDonut"></canvas>
    </div>

    <!-- ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ó‡πà‡∏á -->
    <div class="chart-box" style="height:220px;">
      <canvas id="attendanceBar"></canvas>
    </div>

    <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç -->
<div class="stats-box" id="statsSummaryBox">
  <p>üë• ‡∏°‡∏≤: <b id="statCome">0</b> ‡∏Ñ‡∏ô</p>
  <p>ü§í ‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢: <b id="statSick">0</b> ‡∏Ñ‡∏ô</p>
  <p>üìù ‡∏•‡∏≤‡∏Å‡∏¥‡∏à: <b id="statLeave">0</b> ‡∏Ñ‡∏ô</p>
  <p>‚ùå ‡∏Ç‡∏≤‡∏î: <b id="statAbsent">0</b> ‡∏Ñ‡∏ô</p>
  <p>‚è±Ô∏è OT: <b id="statOT">0</b> ‡∏Ñ‡∏ô</p>
  <hr>
  <p>üìå ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <b id="statTotal">0</b> ‡∏Ñ‡∏ô</p>
</div>
  </div>
</div>


      <div style="display: flex; gap: 10px; justify-content: flex-end; margin-bottom: 15px;">
        <button id="exportExcelPopupBtn" style="background:#217346; color:white; border:none; padding:8px 15px; border-radius:8px; cursor:pointer;">üìä Excel</button>
      </div>

      <div class="table-responsive" style="max-height: 400px;">
        <table>
          <thead><tr><th>‡πÅ‡∏ú‡∏ô‡∏Å</th><th>‡∏£‡∏´‡∏±‡∏™</th><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th>OT</th></tr></thead>
          <tbody id="historyTableBody"><tr><td colspan="6" style="color:#999; padding:20px;">‡∏Å‡∏î‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr></tbody>
        </table>
      </div>
    </div>

    <div id="section-employee" class="content-section">
      <div class="card-header">
        <h2>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h2>
        <p>‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏¢‡πâ‡∏≤‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
      </div>
      
      <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('add')">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</button>
        <button class="tab-btn" onclick="switchTab('transfer')">‡∏¢‡πâ‡∏≤‡∏¢‡πÅ‡∏ú‡∏ô‡∏Å</button>
        <button class="tab-btn" onclick="switchTab('remove')">‡∏•‡∏ö‡∏≠‡∏≠‡∏Å</button>
      </div>

      <div id="tab-add" class="tab-content active">

  <div class="form-grid-emp">

    <div class="field">
      <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
      <select id="add_prefix">
        <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
        <option value="‡∏ô‡∏≤‡∏á">‡∏ô‡∏≤‡∏á</option>
        <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
      </select>
    </div>

    <div class="field">
      <label>‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
      <input type="text" id="add_emp_code" placeholder="‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô">
    </div>

    <div class="field">
      <label>‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á</label>
      <input type="text" id="add_first_name">
    </div>

    <div class="field">
      <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
      <input type="text" id="add_last_name">
    </div>

    <div class="field">
      <label>‡πÅ‡∏ú‡∏ô‡∏Å</label>
      <select id="dept_add">
        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
        <option value="IT">‡∏ù‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ</option>
        <option value="‡∏ö‡∏±‡∏ç‡∏ä‡∏µ">‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏®</option>
        <option value="‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•">‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</option>
        <option value="‡∏Ç‡∏≤‡∏¢">‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£</option>
      </select>
    </div>

    <div class="field">
      <label>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
      <input type="date" id="add_start_date">
    </div>

  </div>

  <button id="saveNewEmployeeBtn" class="btn-main">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

</div>


      <div id="tab-transfer" class="tab-content">
        <div class="search-row">
            <input type="text" id="trans_search_code" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô...">
            <button id="searchTransBtn" class="btn-search">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
        </div>
        <div id="trans_form_area" class="readonly-box">
            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label><input type="text" id="trans_name" readonly>
            <div style="display:flex; gap:10px; align-items:center; margin-top:10px;">
                <div style="flex:1"><label>‡πÅ‡∏ú‡∏ô‡∏Å‡πÄ‡∏î‡∏¥‡∏°</label><input type="text" id="trans_current_dept" readonly></div>
                <div style="font-size:20px;">‚ûî</div>
                <div style="flex:1"><label style="color:var(--primary-color);">‡πÅ‡∏ú‡∏ô‡∏Å‡πÉ‡∏´‡∏°‡πà</label>
                    <select id="trans_new_dept" style="border:2px solid var(--primary-color);"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option><option value="IT">‡∏ù‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ</option><option value="‡∏ö‡∏±‡∏ç‡∏ä‡∏µ">‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏®</option><option value="‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•">‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á</option><option value="‡∏Ç‡∏≤‡∏¢">‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£</option></select>
                </div>
            </div>
            <button id="confirmTransBtn" class="btn-main" style="margin-top:15px; background:#17a2b8;">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡πâ‡∏≤‡∏¢</button>
        </div>
      </div>

      <div id="tab-remove" class="tab-content">
        <div class="search-row">
            <input type="text" id="del_search_code" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô...">
            <button id="searchDelBtn" class="btn-search" style="background:#dc3545;">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
        </div>
        <div id="del_form_area" class="readonly-box" style="border:1px solid #ffebee; background:#fff5f5;">
            <label>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><input type="text" id="del_first_name" readonly>
            <label>‡πÅ‡∏ú‡∏ô‡∏Å</label><input type="text" id="del_dept" readonly>
            <button id="confirmDelBtn" class="btn-main" style="margin-top:15px; background:#dc3545;" disabled>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="js/dashboard_logic.js"></script>
  <script type="module" src="js/attendance.js"></script>
  <script type="module" src="js/add_employee.js?v=20260220-1"></script>
  <script type="module" src="js/history.js?v=20260219-2"></script>
  <script type="module" src="js/qr_access.js"></script>
</body>
</html>
